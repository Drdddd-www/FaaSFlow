main:
  type: workflow
  start: init 
  end: mViewer
  nodes: 
    - name: init
      type: function
      source: init
      next: 
        - mProjectPP1
        - mProjectPP2
        - mProjectPP3
        - mProjectPP4
        - mProjectPP5
        - mProjectPP6
        - mProjectPP7
        - mProjectPP8
    - name: mProjectPP1
      type: function
      source: mProjectPP
      parameters: 
        input_file: input/2mass-atlas-990502s-j1350080.fits
        output_file: projected/2mass-atlas-990502s-j1350080.fits
        template_file: region.hdr
      next: 
        - mImgtbl1
        - mBackground1
    - name: mProjectPP2
      type: function
      source: mProjectPP
      parameters: 
        input_file: input/2mass-atlas-990502s-j1350092.fits
        output_file: projected/2mass-atlas-990502s-j1350092.fits
        template_file: region.hdr
      next: 
        - mImgtbl1
        - mBackground2
    - name: mProjectPP3
      type: function
      source: mProjectPP
      parameters: 
        input_file: input/22mass-atlas-990502s-j1420186.fits
        output_file: projected/2mass-atlas-990502s-j1420186.fits
        template_file: region.hdr
      next: 
        - mImgtbl1
        - mBackground3
    - name: mProjectPP4
      type: function
      source: mProjectPP
      parameters: 
        input_file: input/2mass-atlas-990502s-j1420198.fits
        output_file: projected/2mass-atlas-990502s-j1420198.fits
        template_file: region.hdr
      next: 
        - mImgtbl1
        - mBackground4
    - name: mProjectPP5
      type: function
      source: mProjectPP
      parameters: 
        input_file: input/2mass-atlas-990502s-j1430080.fits
        output_file: projected/2mass-atlas-990502s-j1430080.fits
        template_file: region.hdr
      next: 
        - mImgtbl1
        - mBackground5
    - name: mProjectPP6
      type: function
      source: mProjectPP
      parameters: 
        input_file: input/2mass-atlas-990502s-j1430092.fits
        output_file: projected/2mass-atlas-990502s-j1430092.fits
        template_file: region.hdr
      next: 
        - mImgtbl1
        - mBackground6
    - name: mProjectPP7
      type: function
      source: mProjectPP
      parameters: 
        input_file: input/2mass-atlas-990502s-j1440186.fits
        output_file: projected/2mass-atlas-990502s-j1440186.fits
        template_file: region.hdr
      next: 
        - mImgtbl1
        - mBackground7
    - name: mProjectPP8
      type: function
      source: mProjectPP
      parameters: 
        input_file: input/2mass-atlas-990502s-j1440198.fits
        output_file: projected/2mass-atlas-990502s-j1440198.fits
        template_file: region.hdr
      next: 
        - mImgtbl1
        - mBackground8
    - name: mImgtbl1
      type: function
      source: mImgtbl
      parameters:
        pathname: projected
        tblname: pimages.tbl
      next: mOverlaps
    - name: mOverlaps
      type: function
      source: mOverlaps
      parameters:
        tblfile: pimages.tbl
        difftbl: diffs.tbl
      next: mDiffFitExec
    - name: mDiffFitExec
      type: function
      source: mDiffFitExec
      parameters: 
        path: projected
        tblfile: diffs.tbl
        template: region.hdr
        diffdir: diffs
        fitfile: fits.tbl
      next: mBgModel
    - name: mBgModel
      type: function
      source: mBgModel
      parameters:
        input_file: pimages.tbl        
        fit_file: fits.tbl 
        corr_file: corrections.tbl
      next: 
        - mBackground1
        - mBackground2
        - mBackground3 
        - mBackground4
        - mBackground5
        - mBackground6
        - mBackground7
        - mBackground8
    - name: mBackground1
      type: function
      source: mBackground
      parameters: 
        input_file: projected/2mass-atlas-990502s-j1350080.fits
        output_file: corrected/2mass-atlas-990502s-j1350080.fits
        template_file: region.hdr
        A: $.mBgModel.Output.A[0]      
        B: $.mBgModel.Output.B[0]
        C: $.mBgModel.Output.C[0] 
      next: mImgtbl2
    - name: mBackground2
      type: function
      source: mBackground
      parameters: 
        input_file: projected/2mass-atlas-990502s-j1350092.fits
        output_file: corrected/2mass-atlas-990502s-j1350092.fits
        template_file: region.hdr
        A: $.mBgModel.Output.A[1]      
        B: $.mBgModel.Output.B[1]
        C: $.mBgModel.Output.C[1] 
      next: mImgtbl2
    - name: mBackground3
      type: function
      source: mBackground
      parameters: 
        input_file: projected/22mass-atlas-990502s-j1420186.fits
        output_file: corrected/2mass-atlas-990502s-j1420186.fits
        template_file: region.hdr
        A: $.mBgModel.Output.A[2]      
        B: $.mBgModel.Output.B[2]
        C: $.mBgModel.Output.C[2] 
      next: mImgtbl2
    - name: mBackground4
      type: function
      source: mBackground
      parameters: 
        input_file: projected/2mass-atlas-990502s-j1420198.fits
        output_file: corrected/2mass-atlas-990502s-j1420198.fits
        template_file: region.hdr
        A: $.mBgModel.Output.A[3]      
        B: $.mBgModel.Output.B[3]
        C: $.mBgModel.Output.C[3] 
      next: mImgtbl2
    - name: mBackground5
      type: function
      source: mBackground
      parameters: 
        input_file: projected/2mass-atlas-990502s-j1430080.fits
        output_file: corrected/2mass-atlas-990502s-j1430080.fits
        template_file: region.hdr
        A: $.mBgModel.Output.A[4]      
        B: $.mBgModel.Output.B[4]
        C: $.mBgModel.Output.C[4] 
      next: mImgtbl2
    - name: mBackground6
      type: function
      source: mBackground
      parameters: 
        input_file: projected/2mass-atlas-990502s-j1430092.fits
        output_file: corrected/2mass-atlas-990502s-j1430092.fits
        template_file: region.hdr
        A: $.mBgModel.Output.A[5]      
        B: $.mBgModel.Output.B[5]
        C: $.mBgModel.Output.C[5] 
      next: mImgtbl2
    - name: mBackground7
      type: function
      source: mBackground
      parameters: 
        input_file: projected/2mass-atlas-990502s-j1440186.fits
        output_file: corrected/2mass-atlas-990502s-j1440186.fits
        template_file: region.hdr
        A: $.mBgModel.Output.A[6]      
        B: $.mBgModel.Output.B[6]
        C: $.mBgModel.Output.C[6] 
      next: mImgtbl2
    - name: mBackground8
      type: function
      source: mBackground
      parameters: 
        input_file: projected/2mass-atlas-990502s-j1440198.fits
        output_file: corrected/2mass-atlas-990502s-j1440198.fits
        template_file: region.hdr
        A: $.mBgModel.Output.A[7]      
        B: $.mBgModel.Output.B[7]
        C: $.mBgModel.Output.C[7] 
      next: mImgtbl2
    - name: mImgtbl2
      type: function
      source: mImgtbl
      parameters:
        pathname: corrected
        tblname: cimages.tbl
      next: mAdd
    - name: mAdd
      type: function
      source: mAdd
      parameters:
        path: corrected
        tblfile: cimages.tbl
        template_file: region.hdr
        outfile: mosaic.fits
      next: mViewer
    - name: mViewer
      type: function
      source: mViewer
      parameters:
        cmdstr: -ct 1 -gray mosaic.fits -2s max gaussian-log -out mosaic.png